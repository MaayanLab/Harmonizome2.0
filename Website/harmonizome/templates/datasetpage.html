{% extends "layout.html" %}
{% block content %}
<div>
<h1>{{ dataset.name }} <span class="note dataset">Dataset</span></h1>
</div>
<div class="col-md-8">
  <br >
  <table class="table">
    <tr>
        <td>Description</td>
        <td>{{ dataset.description }}</td>
    </tr>
    <tr>
        <td>Measurement</td>
        <td>{{ dataset.measurement }}</td>
    </tr>
    <tr>
        <td>Association</td>
        <td>{{ dataset.association }}</td>
    </tr>
    <tr>
        <td>Category</td>
        <td>{{ dataset.category }}</td>
    </tr>
    <tr>
        <td>Resource</td>
        <td>
            <a href="resourcepage/dataset.resource">
                {{ dataset.resource }}
            </a>
        </td>
    </tr>
    <tr>
        <td>Citation(s)</td>
        <td>
            <ul>
            {%  for citation in citations %}
              <li>
                  {{ citation.citation }}</a>
              </li>
              {% endfor %}
            </ul>
        </td>
    </tr>
  </table>
</div>

<div class="col-md-4">
  <h3>Stats</h3>
  <div class="col-md-4">
    <div id="gene_metric"></div>
  </div>
  <div class="col-md-4">
    <div id="attribute_metric"></div>
  </div>
  <div class="col-md-4">
    <div id="association_metric"></div>
  </div>
</div>

<div class="col-md-12">
  <h1>Download Data</h1>
  <br >

  <div class="col-md-12" style="padding-bottom: 20px">

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ UPM.name }}</h5>
          <a href='{{ UPM.external_link }}'><img src="{{ url_for('static', filename='images/UnfilterdMatrix.png') }}" height="70" width="100"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/UnprocessedValue.png') }}" height="8" width="8"></img> Unprocessed Expression Value <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ PM.name }}</h5>
          <a href='{{ PM.external_link }}'><img src="{{ url_for('static', filename='images/FilterdMatrix.png') }}" height="70" width="100"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/NormalizedValue.png') }}" height="8" width="8"></img> Unprocessed Expression Value <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ SM.name }}</h5>
          <a href='{{ SM.external_link }}'><img src="{{ url_for('static', filename='images/StandardizedMatrix.png') }}" height="70" width="100"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px;  font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/StandardValue.png') }}" height="8" width="8"></img> Standardized Expression Value <br >
          </div>
        </div>
      </div>
    </div>
{#
    <!-- <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ TM.name }}</h5>
          <a href='{{ TM.external_link }}'><img src="{{ url_for('static', filename='images/BinaryTertiaryMatrix.png') }}" height="70" width="100"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/TertiaryValue.png') }}" height="8" width="8"></img> Tertiary/Binary Expression Value <br >
          </div>
        </div>
      </div>
    </div> -->
#}

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ GS.name }}</h5>
          <a href='{{ GS.external_link }}'><img src="{{ url_for('static', filename='images/GeneSimilarityMatrix.png') }}" height="70" width="100"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/GeneSimilarityValue.png') }}" height="8" width="8"></img> Attribute Down Regulated by Gene <br >
          </div>
          <br >
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ AS.name }}</h5>
          <a href='{{ AS.external_link }}'><img src="{{ url_for('static', filename='images/AttributeSimilarityMatrix.png') }}" height="70" width="100"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/AttributeSimilarityValue.png') }}" height="8" width="8"></img> Attribute Down Regulated by Gene <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ E.name }}</h5>
          <a href='{{ E.external_link }}'><img src="{{ url_for('static', filename='images/EdgeList.png') }}"  height="70" width="60"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/UnprocessedValue.png') }}" height="8" width="8"></img> Weight <br >
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="col-md-12" style="padding-bottom: 20px">

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ UG.name }}</h5>
          <a href='{{ UG.external_link }}'><img src="{{ url_for('static', filename='images/AttributeUpSet.png') }}" height="70" width="110"style="margin-top: 18px;"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px;  font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/UpGene.png') }}" height="8" width="8"></img> Up Regulated Gene <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ DG.name }}</h5>
          <a href='{{ DG.external_link }}'><img src="{{ url_for('static', filename='images/AttributeDownSet.png') }}" height="70" width="110"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
            <img src="{{ url_for('static', filename='images/DownGene.png') }}" height="8" width="8"></img> Down Regulated Gene <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ UA.name }}</h5>
          <a href='{{ UA.external_link }}'><img src="{{ url_for('static', filename='images/UpGeneSet.png') }}" height="70" width="110"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/UpAttribute.png') }}" height="8" width="8"></img> Attribute Up Regulated by Gene <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ DA.name }}</h5>
          <a href='{{ DA.external_link }}'><img src="{{ url_for('static', filename='images/DownGeneSet.png') }}" height="70" width="110"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
            <img src="{{ url_for('static', filename='images/DownAttribute.png') }}" height="8" width="8"></img> Attribute Down Regulated by Gene <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ GL.name }}</h5>
          <a href='{{ GL.external_link }}'><img src="{{ url_for('static', filename='images/GeneList.png') }}" height="70" width="35" style="margin-top: 20px;"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Gene.png') }}" height="8" width="8"></img> Gene <br >
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-2" align="center">
      <div class="card">
        <div class="card-container">
          <h5>{{ AL.name }}</h5>
          <a href='{{ AL.external_link }}'><img src="{{ url_for('static', filename='images/AttributeList.png') }}"  height="70" width="30" style="margin-top: 20px;"></img></a>
          <div align="left" style="position: absolute; bottom: 0; padding: 10px; font-size: 10px;">
            <img src="{{ url_for('static', filename='images/Attribute.png') }}" height="8" width="8"></img> Attribute <br >
          </div>
        </div>
      </div>
    </div>
  </div>

</div>

<div class="col-md-12">

  <script>
    function popitup(url) {
    const newwindow = window.open(url, 'name', 'top=100, left=2500, width=1000, height=800');
    if (window.focus) { newwindow.focus(); }
    return false;
  }
  </script>

  <h1>Data Visulization</h1>
  <div class="col-md-4" align="center">
    <h5>Dataset</h5>
    <div class='vis'>
      <a onclick={popitup('http://localhost:5000/harmonizome/datavisulization')}><img src="{{ url_for('static', filename='images/clustergrammerMatrix.png') }}" height="200" width="250" alt=""></img></a>
    </div>
  </div>
  <div class="col-md-4" align="center">
    <h5>Cell Line Similarity</h5>
    <div class='vis'>
      <a onclick={popitup('http://localhost:5000/harmonizome/datavisulization')}><img src="{{ url_for('static', filename='images/clustergrammerSim1.png') }}" height="200" width="250" alt=""></img></a>
    </div>
  </div>
  <div class="col-md-4" align="center">
    <h5>Gene Similarity</h5>
    <div class='vis'>
      <a onclick={popitup('http://localhost:5000/harmonizome/datavisulization')}><img src="{{ url_for('static', filename='images/clustergrammerSim2.png') }}" height="200" width="250" alt=""></img></a>
    </div>
  </div>
</div>



<div class="col-md-12">
  <h1>Gene Sets</h1>
  <br >
  <br >
</div>

<script src="https://d3js.org/d3.v4.js"></script>
<script src="{{ url_for('static', filename='js/d3-tip.js') }}"></script>


<div class="col-md-12">
  <div class="wrapper">
    <div class="container">
      <div class="download-page">
        <div class="table-responsive">
          <table class="table data-table">
            <thead>
              <tr>
                <th>Cell Line</th>
                <th>Gene Set</th>
              </tr>
            </thead>
              <tbody>
                {% for attribute in attributes %}
                  <script>
                    var data=[
                      {% for association in associations %}
                        {% if association.attribute == attribute[0] %}
                          {name: '{{ association.gene }}', value: {{ association.weight }}},
                        {% endif %}
                      {% endfor %}
                    ];
                    var id = 'A'+'{{ attribute[0] }}'
                    var url = '/harmonizome/genepage/'
                  </script>
                <tr>
                  <td>
                    <b>{{  attribute[0] }}</a>
                  </td>
                  <td id='A{{ attribute[0] }}'>
                    <script type="text/javascript" src="{{ url_for('static', filename='js/geneSetBarChart.js') }}">
                    </script>
                  </td>
                </tr>
               {% endfor %}
             </tbody>
         </table>
        </div>
      </div>
    </div>
  </div>
</div>

  <script src="{{ url_for('static', filename='js/download-page.js') }}"></script>
  <script>
  	setupDataTable();
  </script>

</div>




<script>
  var pie1 = new d3pie("gene_metric", {
    "header": {
      "title": {
        "text": "{{ dataset.numb_genes }}",
        "fontSize": 18,
        "font": "Sans-serif"
      },
      "subtitle": {
        "text": "Genes",
        "color": "#999999",
        "fontSize": 12,
        "font": "Sans-serif"
      },
      "location": "pie-center",
      "titleSubtitlePadding": 10
    },
    "footer": {
      "text": "",
      "color": "#999999",
      "fontSize": 10,
      "font": "open sans",
      "location": "bottom-left"
    },
    "size": {
      "canvasHeight": 120,
      "canvasWidth": 120,
      "pieInnerRadius": "90%",
      "pieOuterRadius": "100%"
    },
    "data": {
      "sortOrder": "label-desc",

      "content": [
        {
          "value": {{ dataset.numb_genes }},
          "color": "#4286f4"
        },
      ]

    },
    "labels": {
      "outer": {
        "format": "label-percentage2",
        "pieDistance": 6
      },
      "inner": {
        "format": "none"
      },
      "mainLabel": {
        "fontSize": 11
      },
      "percentage": {
        "color": "#999999",
        "fontSize": 11,
        "decimalPlaces": 0
      },
      "value": {
        "color": "#cccc43",
        "fontSize": 7
      },
      "lines": {
        "enabled": true,
        "color": "#777777"
      },
      "truncation": {
        "enabled": true
      }
    },
  });

  var pie2 = new d3pie("attribute_metric", {
    "header": {
      "title": {
        "text": "{{ dataset.numb_associations }}",
        "fontSize": 18,
        "font": "Sans-serif"
      },
      "subtitle": {
        "text": "Cell Lines",
        "color": "#999999",
        "fontSize": 12,
        "font": "Sans-serif"
      },
      "location": "pie-center",
      "titleSubtitlePadding": 10
    },
    "footer": {
      "text": "",
      "color": "#999999",
      "fontSize": 10,
      "font": "open sans",
      "location": "bottom-left"
    },
    "size": {
      "canvasHeight": 120,
      "canvasWidth": 120,
      "pieInnerRadius": "90%",
      "pieOuterRadius": "100%"
    },
    "data": {
      "sortOrder": "label-desc",

      "content": [
        {
          "value": {{ dataset.numb_associations }},
          "color": "#f4415c"
        },
      ]

    },
    "labels": {
      "outer": {
        "format": "label-percentage2",
        "pieDistance": 6
      },
      "inner": {
        "format": "none"
      },
      "mainLabel": {
        "fontSize": 11
      },
      "percentage": {
        "color": "#999999",
        "fontSize": 11,
        "decimalPlaces": 0
      },
      "value": {
        "color": "#cccc43",
        "fontSize": 7
      },
      "lines": {
        "enabled": true,
        "color": "#777777"
      },
      "truncation": {
        "enabled": true
      }
    },
  });
  var pie3 = new d3pie("association_metric", {
    "header": {
      "title": {
        "text": "{{ dataset.numb_gene_associations }}",
        "fontSize": 16,
        "font": "Sans-serif"
      },
      "subtitle": {
        "text": "Associations",
        "color": "#999999",
        "fontSize": 12,
        "font": "Sans-serif"
      },
      "location": "pie-center",
      "titleSubtitlePadding": 10
    },
    "footer": {
      "text": "",
      "color": "#999999",
      "fontSize": 10,
      "font": "open sans",
      "location": "bottom-left"
    },
    "size": {
      "canvasHeight": 120,
      "canvasWidth": 120,
      "pieInnerRadius": "90%",
      "pieOuterRadius": "100%"
    },
    "data": {
      "sortOrder": "label-desc",

      "content": [
        {
          "value": {{ dataset.numb_gene_associations }},
          "color": "#d341f4"
        },
      ]

    },
    "labels": {
      "outer": {
        "format": "label-percentage2",
        "pieDistance": 6
      },
      "inner": {
        "format": "none"
      },
      "mainLabel": {
        "fontSize": 11
      },
      "percentage": {
        "color": "#999999",
        "fontSize": 11,
        "decimalPlaces": 0
      },
      "value": {
        "color": "#cccc43",
        "fontSize": 7
      },
      "lines": {
        "enabled": true,
        "color": "#777777"
      },
      "truncation": {
        "enabled": true
      }
    },
  });
</script>

{% endblock %}
